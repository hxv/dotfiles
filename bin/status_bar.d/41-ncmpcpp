#!/usr/bin/env bash

STATUS=$(echo status | ncat localhost 6600 2>/dev/null)

if [ "$?" -ne 0 ]; then
    exit
fi

CURRENT=$(echo currentsong | ncat localhost 6600 2>/dev/null | grep -P '^(Artist|Title): ' | perl -pe 's/^(Artist|Title): //g' | perl -pe 's/\n/ - /g' | perl -pe 's/ - $//')

STATE=$(echo "$STATUS" | grep -P '^state: ' | sed 's/state: //')

if [ "$STATE" == "stop" ]; then
    exit
elif [ "$STATE" == "pause" ]; then
	echo -n " "
else
	echo -n " "
fi

echo "$CURRENT"

